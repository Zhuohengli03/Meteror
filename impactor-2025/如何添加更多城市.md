# 如何手动添加更多城市

## 方法：编辑备用数据库

### 步骤 1: 打开文件

编辑 `backend/app/services/geonames_client.py`

### 步骤 2: 找到 FALLBACK_CITIES

在文件中找到 `FALLBACK_CITIES = [` 这一行（大约第 140 行）

### 步骤 3: 添加城市

在列表末尾添加新城市（在最后一个 `]` 之前）：

```python
FALLBACK_CITIES = [
    # ... 现有城市 ...
    
    # 添加中国城市
    {"name": "天津", "country": "China", "latitude": 39.1422, "longitude": 117.1767, 
     "population": 15621000, "gdp_per_capita": 15000},
    {"name": "成都", "country": "China", "latitude": 30.5728, "longitude": 104.0668, 
     "population": 20937757, "gdp_per_capita": 15000},
    {"name": "重庆", "country": "China", "latitude": 29.4316, "longitude": 106.9123, 
     "population": 32054200, "gdp_per_capita": 15000},
    {"name": "武汉", "country": "China", "latitude": 30.5928, "longitude": 114.3055, 
     "population": 12326518, "gdp_per_capita": 15000},
    {"name": "西安", "country": "China", "latitude": 34.3416, "longitude": 108.9398, 
     "population": 12952907, "gdp_per_capita": 15000},
    {"name": "杭州", "country": "China", "latitude": 30.2741, "longitude": 120.1551, 
     "population": 11936010, "gdp_per_capita": 15000},
    {"name": "南京", "country": "China", "latitude": 32.0603, "longitude": 118.7969, 
     "population": 9314685, "gdp_per_capita": 15000},
    {"name": "苏州", "country": "China", "latitude": 31.2989, "longitude": 120.5853, 
     "population": 12748262, "gdp_per_capita": 15000},
    
    # 添加其他国家城市
    {"name": "法兰克福", "country": "Germany", "latitude": 50.1109, "longitude": 8.6821, 
     "population": 753056, "gdp_per_capita": 45000},
    {"name": "阿姆斯特丹", "country": "Netherlands", "latitude": 52.3676, "longitude": 4.9041, 
     "population": 872680, "gdp_per_capita": 50000},
]
```

### 步骤 4: 获取城市数据

**坐标和人口数据来源**:
- Google Maps（坐标）
- Wikipedia（人口）
- 各国统计局

**GDP per capita 参考**:
- 美国: 65000
- 中国: 15000
- 日本: 40000
- 欧洲发达国家: 40000-50000
- 印度: 2000
- 非洲: 1000-3000

### 步骤 5: 重启后端

```bash
cd backend
lsof -ti:8001 | xargs kill -9
python3 -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8001
```

---

## 常用中国城市数据

```python
# 一线城市
{"name": "北京", "country": "China", "latitude": 39.9042, "longitude": 116.4074, 
 "population": 21540000, "gdp_per_capita": 15000},
{"name": "上海", "country": "China", "latitude": 31.2304, "longitude": 121.4737, 
 "population": 24870895, "gdp_per_capita": 15000},
{"name": "广州", "country": "China", "latitude": 23.1291, "longitude": 113.2644, 
 "population": 14043500, "gdp_per_capita": 15000},
{"name": "深圳", "country": "China", "latitude": 22.5431, "longitude": 114.0579, 
 "population": 12356820, "gdp_per_capita": 15000},

# 新一线城市
{"name": "成都", "country": "China", "latitude": 30.5728, "longitude": 104.0668, 
 "population": 20937757, "gdp_per_capita": 15000},
{"name": "杭州", "country": "China", "latitude": 30.2741, "longitude": 120.1551, 
 "population": 11936010, "gdp_per_capita": 15000},
{"name": "重庆", "country": "China", "latitude": 29.4316, "longitude": 106.9123, 
 "population": 32054200, "gdp_per_capita": 15000},
{"name": "武汉", "country": "China", "latitude": 30.5928, "longitude": 114.3055, 
 "population": 12326518, "gdp_per_capita": 15000},
{"name": "西安", "country": "China", "latitude": 34.3416, "longitude": 108.9398, 
 "population": 12952907, "gdp_per_capita": 15000},
{"name": "天津", "country": "China", "latitude": 39.1422, "longitude": 117.1767, 
 "population": 15621000, "gdp_per_capita": 15000},
{"name": "南京", "country": "China", "latitude": 32.0603, "longitude": 118.7969, 
 "population": 9314685, "gdp_per_capita": 15000},
{"name": "苏州", "country": "China", "latitude": 31.2989, "longitude": 120.5853, 
 "population": 12748262, "gdp_per_capita": 15000},
{"name": "长沙", "country": "China", "latitude": 28.2282, "longitude": 112.9388, 
 "population": 10047914, "gdp_per_capita": 15000},
{"name": "郑州", "country": "China", "latitude": 34.7466, "longitude": 113.6253, 
 "population": 12600574, "gdp_per_capita": 15000},
```

---

## 注意事项

1. **格式要严格**: 每个城市都要有逗号，最后一个城市后面也要有逗号
2. **坐标格式**: 纬度在前，经度在后
3. **人口数据**: 尽量使用最新的官方数据
4. **GDP估算**: 可以使用国家平均值

---

## 推荐：使用 GeoNames API

手动添加城市很麻烦，强烈推荐使用 GeoNames API：
- ✅ 1100万+ 城市数据
- ✅ 自动更新
- ✅ 免费使用
- ✅ 只需注册一次
